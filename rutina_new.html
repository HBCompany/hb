<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="css/rutina_new.css">
    <link href="https://fonts.googleapis.com/css?family=Pacifico&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Russo+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Permanent+Marker&display=swap" rel="stylesheet">
    <title>Утренняя рутина</title>
</head>
<body>

<div class="grid main">
    <div class="block-logo">
        <div><a href="setting.html"><img src="img/setting.png" class="image-men" alt="Настройки"></a></div>
        <div class="head-logo"><h1>HomeBook</h1></div>
        <div></div>
    </div>
    <div>
        <h2>Утренние рутины</h2>
        <div class="container">
            <p>
                <label for="new-task">Add Item</label><input  id="new-task" type="text" ><button class="input-submit">Add</button>
            </p>
            <div class="margin-block">
            <h3>Todo</h3>
            <ul id="incomplete-tasks">
                <li class="editMode"><input type="checkbox"><label>Go Shopping</label><input  type="text" class="input-edit" value="Go Shopping"><button class="edit input-submit btn-ed-del"></button><button class="delete input-submit btn-ed-del">Delete</button></li>
                <li class="editMode"><input type="checkbox"><label>Go Shopping</label><input  type="text" class="input-edit" value="Go Shopping"><button class="edit input-submit btn-ed-del"></button><button class="delete input-submit btn-ed-del">Delete</button></li>
                <li class="editMode"><input type="checkbox"><label>Go Shopping</label><input  type="text" class="input-edit" value="Go Shopping"><button class="edit input-submit btn-ed-del"></button><button class="delete input-submit btn-ed-del">Delete</button></li>
            </ul>
            </div>
            <h3>Completed</h3>
            <ul id="completed-tasks">
                <li class="editMode"><input type="checkbox" checked><label>See the Doctor</label><input type="text" value="Go Shopping"><button class="edit input-submit btn-ed-del"></button><button class="delete input-submit btn-ed-del">Delete</button></li>
            </ul>
        </div>

        <script>
            var taskInput=document.getElementById("new-task");//Add a new task.
            var addButton=document.getElementsByTagName("button")[0];//first button
            var incompleteTaskHolder=document.getElementById("incomplete-tasks");//ul of #incomplete-tasks
            var completedTasksHolder=document.getElementById("completed-tasks");//completed-tasks


            //New task list item
            var createNewTaskElement=function(taskString){

                var listItem=document.createElement("li");

                //input (checkbox)
                var checkBox=document.createElement("input");//checkbx
                //label
                var label=document.createElement("label");//label
                //input (text)
                var editInput=document.createElement("input");//text
                //button.edit
                var editButton=document.createElement("button");//edit button

                //button.delete
                var deleteButton=document.createElement("button");//delete button

                label.innerText=taskString;

                //Each elements, needs appending
                checkBox.type="checkbox";
                editInput.type="text";

                editButton.innerText="Edit";//innerText encodes special characters, HTML does not.
                editButton.className="edit";
                deleteButton.innerText="Delete";
                deleteButton.className="delete";



                //and appending.
                listItem.appendChild(checkBox);
                listItem.appendChild(label);
                listItem.appendChild(editInput);
                listItem.appendChild(editButton);
                listItem.appendChild(deleteButton);
                return listItem;
            }



            var addTask=function(){
                console.log("Add Task...");
                //Create a new list item with the text from the #new-task:
                var listItem=createNewTaskElement(taskInput.value);

                //Append listItem to incompleteTaskHolder
                incompleteTaskHolder.appendChild(listItem);
                bindTaskEvents(listItem, taskCompleted);

                taskInput.value="";

            }

            //Edit an existing task.

            var editTask=function(){
                console.log("Edit Task...");
                console.log("Change 'edit' to 'save'");


                var listItem=this.parentNode;

                var editInput=listItem.querySelector('input[type=text]');
                var label=listItem.querySelector("label");
                var containsClass=listItem.classList.contains("editMode");
                //If class of the parent is .editmode
                if(containsClass){

                    //switch to .editmode
                    //label becomes the inputs value.
                    label.innerText=editInput.value;
                }else{
                    editInput.value=label.innerText;
                }

                //toggle .editmode on the parent.
                listItem.classList.toggle("editMode");
            }




            //Delete task.
            var deleteTask=function(){
                console.log("Delete Task...");

                var listItem=this.parentNode;
                var ul=listItem.parentNode;
                //Remove the parent list item from the ul.
                ul.removeChild(listItem);

            }


            //Mark task completed
            var taskCompleted=function(){
                console.log("Complete Task...");

                //Append the task list item to the #completed-tasks
                var listItem=this.parentNode;
                completedTasksHolder.appendChild(listItem);
                bindTaskEvents(listItem, taskIncomplete);

            }


            var taskIncomplete=function(){
                console.log("Incomplete Task...");
//Mark task as incomplete.
                //When the checkbox is unchecked
                //Append the task list item to the #incomplete-tasks.
                var listItem=this.parentNode;
                incompleteTaskHolder.appendChild(listItem);
                bindTaskEvents(listItem,taskCompleted);
            }



            var ajaxRequest=function(){
                console.log("AJAX Request");
            }

            //The glue to hold it all together.


            //Set the click handler to the addTask function.
            addButton.onclick=addTask;
            addButton.addEventListener("click",addTask);
            addButton.addEventListener("click",ajaxRequest);


            var bindTaskEvents=function(taskListItem,checkBoxEventHandler){
                console.log("bind list item events");
//select ListItems children
                var checkBox=taskListItem.querySelector("input[type=checkbox]");
                var editButton=taskListItem.querySelector("button.edit");
                var deleteButton=taskListItem.querySelector("button.delete");


                //Bind editTask to edit button.
                editButton.onclick=editTask;
                //Bind deleteTask to delete button.
                deleteButton.onclick=deleteTask;
                //Bind taskCompleted to checkBoxEventHandler.
                checkBox.onchange=checkBoxEventHandler;
            }

            //cycle over incompleteTaskHolder ul list items
            //for each list item
            for (var i=0; i<incompleteTaskHolder.children.length;i++){

                //bind events to list items chldren(tasksCompleted)
                bindTaskEvents(incompleteTaskHolder.children[i],taskCompleted);
            }




            //cycle over completedTasksHolder ul list items
            for (var i=0; i<completedTasksHolder.children.length;i++){
                //bind events to list items chldren(tasksIncompleted)
                bindTaskEvents(completedTasksHolder.children[i],taskIncomplete);
            }

        </script>
    </div>

</div>
</body>
</html>

